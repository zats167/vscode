<?php
 goto YG6q1; tpL59: class PKCS7Encoder { public static $block_size = 32; function encode($text) { goto dMUfV; gwKb2: $text_length = strlen($text); goto f0th5; VAqwN: $index++; goto Ypmkt; Pv1N5: return $text . $tmp; goto i0U0n; hcwPj: $tmp = ''; goto O_IQQ; hFlD1: $pad_chr = chr($amount_to_pad); goto hcwPj; iSdQX: OEaFB: goto VAqwN; DlxIs: $amount_to_pad = PKCS7Encoder::block_size; goto AoK7y; dMUfV: $block_size = PKCS7Encoder::$block_size; goto gwKb2; rYQ0v: $tmp .= $pad_chr; goto iSdQX; f0th5: $amount_to_pad = PKCS7Encoder::$block_size - $text_length % PKCS7Encoder::$block_size; goto MhnVx; QFbmq: Ytrni: goto Pv1N5; Klwmh: CEO5z: goto db64i; Ypmkt: goto CEO5z; goto QFbmq; AoK7y: SGFQ7: goto hFlD1; O_IQQ: $index = 0; goto Klwmh; MhnVx: if (!($amount_to_pad == 0)) { goto SGFQ7; } goto DlxIs; db64i: if (!($index < $amount_to_pad)) { goto Ytrni; } goto rYQ0v; i0U0n: } function decode($text) { goto AmYVS; OA3Hp: return substr($text, 0, strlen($text) - $pad); goto ObJtS; O3Xkf: if (!($pad < 1 || $pad > 32)) { goto EN0eI; } goto T0lD0; T0lD0: $pad = 0; goto PQIpW; AmYVS: $pad = ord(substr($text, -1)); goto O3Xkf; PQIpW: EN0eI: goto OA3Hp; ObJtS: } } goto cmsDp; YG6q1: include_once "\x65\x72\162\157\162\103\x6f\x64\145\56\160\150\160"; goto tpL59; cmsDp: class Prpcrypt { public $key; function Prpcrypt($k) { $this->key = base64_decode($k . "\75"); } public function encrypt($text, $appid) { try { goto pQZUX; E2b03: $size = mcrypt_get_block_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC); goto MLAiR; exE22: mcrypt_module_close($module); goto cK3ZJ; IOujn: $text = $pkc_encoder->encode($text); goto KkTof; kPRBC: $pkc_encoder = new PKCS7Encoder(); goto IOujn; dphcs: $iv = substr($this->key, 0, 16); goto kPRBC; cK3ZJ: return array(ErrorCode::$OK, base64_encode($encrypted)); goto K50wJ; eOF23: $encrypted = mcrypt_generic($module, $text); goto G19G4; w6f_x: $text = $random . pack("\x4e", strlen($text)) . $text . $appid; goto E2b03; pQZUX: $random = $this->getRandomStr(); goto w6f_x; MLAiR: $module = mcrypt_module_open(MCRYPT_RIJNDAEL_128, '', MCRYPT_MODE_CBC, ''); goto dphcs; G19G4: mcrypt_generic_deinit($module); goto exE22; KkTof: mcrypt_generic_init($module, $this->key, $iv); goto eOF23; K50wJ: } catch (Exception $e) { return array(ErrorCode::$EncryptAESError, null); } } public function decrypt($encrypted, $appid) { goto ifdMD; ifdMD: try { goto bqZCP; bqZCP: $ciphertext_dec = base64_decode($encrypted); goto ym535; mnt1_: mcrypt_generic_init($module, $this->key, $iv); goto ePUfm; ym535: $module = mcrypt_module_open(MCRYPT_RIJNDAEL_128, '', MCRYPT_MODE_CBC, ''); goto Q98wC; TJ1OP: mcrypt_generic_deinit($module); goto X7SKy; Q98wC: $iv = substr($this->key, 0, 16); goto mnt1_; X7SKy: mcrypt_module_close($module); goto nuVsC; ePUfm: $decrypted = mdecrypt_generic($module, $ciphertext_dec); goto TJ1OP; nuVsC: } catch (Exception $e) { return array(ErrorCode::$DecryptAESError, null); } goto knx81; Eo21r: xDo1T: goto ouvD7; knx81: try { goto PeTuW; RasF6: $content = substr($result, 16, strlen($result)); goto pQ2sY; Ufgcu: $xml_content = substr($content, 4, $xml_len); goto QW4AO; hoTVb: if (!(strlen($result) < 16)) { goto WRQLb; } goto O3doy; QW4AO: $from_appid = substr($content, $xml_len + 4); goto Ira_x; PeTuW: $pkc_encoder = new PKCS7Encoder(); goto GOkSr; pQ2sY: $len_list = unpack("\x4e", substr($content, 0, 4)); goto LTozV; GOkSr: $result = $pkc_encoder->decode($decrypted); goto hoTVb; O3doy: return ''; goto rXDpJ; LTozV: $xml_len = $len_list[1]; goto Ufgcu; rXDpJ: WRQLb: goto RasF6; Ira_x: } catch (Exception $e) { return array(ErrorCode::$IllegalBuffer, null); } goto Wkgtc; ouvD7: return array(0, $xml_content); goto uO3r0; QhQWD: return array(ErrorCode::$ValidateAppidError, null); goto Eo21r; Wkgtc: if (!($from_appid != $appid)) { goto xDo1T; } goto QhQWD; uO3r0: } function getRandomStr() { goto UEAdb; R5I2K: return $str; goto yq2CO; qPtJ9: $str_pol = "\101\x42\x43\x44\105\x46\107\110\111\x4a\x4b\x4c\x4d\116\117\120\x51\x52\123\124\x55\126\127\x58\131\x5a\60\61\62\63\x34\x35\66\x37\x38\71\x61\142\x63\x64\x65\146\x67\150\151\x6a\153\154\x6d\156\157\x70\161\162\163\164\x75\x76\167\170\171\172"; goto b_kbH; VEdN5: $str .= $str_pol[mt_rand(0, $max)]; goto etBwt; etBwt: ub_0J: goto Sgukn; oky9A: DqAaW: goto oC3fK; jmXs3: $i = 0; goto oky9A; v9IsF: goto DqAaW; goto XsDl6; XsDl6: dQHi_: goto R5I2K; UEAdb: $str = ''; goto qPtJ9; b_kbH: $max = strlen($str_pol) - 1; goto jmXs3; oC3fK: if (!($i < 16)) { goto dQHi_; } goto VEdN5; Sgukn: $i++; goto v9IsF; yq2CO: } }