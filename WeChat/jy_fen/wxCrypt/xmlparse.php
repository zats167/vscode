<?php
 include_once "\x65\x72\162\x6f\162\103\x6f\x64\145\56\x70\150\160"; class XMLParse { public function extract($xmltext) { try { goto cK1fC; wQbpr: $xml->loadXML($xmltext); goto NW6XT; cK1fC: $xml = new DOMDocument(); goto wQbpr; czxZF: $tousername = $array_a->item(0)->nodeValue; goto nCTxk; NW6XT: $array_e = $xml->getElementsByTagName("\105\x6e\x63\x72\171\x70\164"); goto JiMhl; nCTxk: return array(0, $encrypt, $tousername); goto YwSJZ; yVUw6: $encrypt = $array_e->item(0)->nodeValue; goto czxZF; JiMhl: $array_a = $xml->getElementsByTagName("\124\157\x55\x73\145\x72\116\141\155\x65"); goto yVUw6; YwSJZ: } catch (Exception $e) { return array(ErrorCode::$ParseXmlError, null, null); } } public function generate($encrypt, $signature, $timestamp, $nonce) { $format = "\x3c\170\x6d\154\x3e\xd\12\x3c\105\156\x63\162\171\x70\164\x3e\x3c\41\x5b\x43\104\101\124\101\133\45\163\x5d\135\76\x3c\57\105\156\x63\x72\x79\160\x74\76\15\12\x3c\x4d\163\x67\x53\x69\x67\156\x61\164\165\x72\x65\x3e\x3c\41\133\103\104\x41\x54\x41\x5b\x25\163\135\x5d\76\x3c\x2f\x4d\x73\x67\123\x69\x67\x6e\x61\x74\x75\162\x65\x3e\xd\xa\74\x54\x69\155\145\123\x74\141\155\160\76\x25\x73\x3c\57\124\151\x6d\x65\123\x74\141\155\x70\76\15\xa\x3c\116\x6f\x6e\x63\x65\x3e\74\41\x5b\103\104\x41\124\x41\x5b\45\x73\x5d\x5d\x3e\74\x2f\x4e\157\x6e\143\x65\76\15\xa\74\57\x78\x6d\154\x3e"; return sprintf($format, $encrypt, $signature, $timestamp, $nonce); } }